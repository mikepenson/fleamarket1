## 如何运行该项目？
### 1.安装相关运行环境
MyEclipse10.7+Tomcat6或以上+JDK1.6或以上
### 2.导入数据库。
数据库脚本在WebRoot--》resources中，数据库名称：fleamarket1
### 3.导入依赖包。
![](http://7xtdsw.com1.z0.glb.clouddn.com/fleamarket%E4%BE%9D%E8%B5%96%E5%8C%85.png)

相关Jar包（百度云云盘）： 链接：http://pan.baidu.com/s/1hr8er0w 密码：41oe

### 4. 修改相关资源配置文件
![](http://7xtdsw.com1.z0.glb.clouddn.com/%E8%B5%84%E6%BA%90%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6.png)

注意：上传图片在服务器中的目录下，一旦将项目从服务器移除掉相关的图片也会消失。这也是相关图片显示不出来的原因，gay友们可以自己发布商品查看。

> 以上要是有什么问题或建议大家可以QQ或邮箱联系我：1327876510@qq.com。以下是我重构这个项目的写的相关文档，没那么完整敬请原谅！


## 逻辑思路
1. 后台商品类别用EasyUI的treegrid显示，所以商品类别对应子类别是一对多约束
2. 发布商品和求购商品用一个bizType标识，0：发布（想卖），1：求购（想买），2：以旧换新
3. 商品管理页面：只有删除和查询 查询类别--》子类别 or 商品名称--》商品列表
4. 用户管理页面：删除用户，查询用户
5. 类别管理页面：添加大类、（选中大类复选框）添加小类，更新类别，删除类别（删除大类确认是否同时删除小类）

## 9月9日
1，类别管理页面：页面用表格相对好，树状表格有点大题小用！采用分页技术

- 查询显示大类和商品列表；
- 添加类别：只有在根节点和根节点下一级的节点才能有此操作，选中根节点则添加类别，选中根节点的下一级节点添加类别，注意需要传类别节点的id，添加节点后需要重新请求一下页面
- 更新类别：判断是大类还是小类，然后发送相应的请求。
- 删除类别：只有在根节点下一级和下下级的节点才能有此操作！如果该类别节点下有子类别，该类别节点不能删除，避免误操作，确保安全性，
类别不是很多就不用查询

2，商品管理页面：同样采用表格和分页技术

- 查询商品：大小类ajax级联查询，商品名称关键字模糊查询
- 删除商品：选中商品根据商品ids删除，多个id删除情况
- 没必要增改商品功能

3，用户管理页面：
- 删除用户
- 查询用户（根据关键字），查出来删了，多个用户被删除，
删除用户收藏信息也会被删除    获取查询用户列表--》转化成json格式数据--》前台显示（过滤密码）

注意：删除的时候注意多个对象，还要注意两个页面不能同时删除？？？


4， Datagrid常见属性
DataGrid控件的一些属性：

        url表示要显示的数据来源，这里设置成datagrid_data.json表示数据来源是这个json文件，放在WebRoot目录下了；

        loadMsg表示加载数据过程中显示的信息；

        queryParams表示传给后台的参数，在这里用不到，因为我们目前还没有和后台关联上，只是显示一个json文件，后面会用到；

        fitColums设置为true后表示水平自动展开，自适应网格的宽度，如此设置，水平方向就不会有滚动条了，也不用设置宽度了；

        width是宽度，如果数据过长显示不下，水平方向就会出现滚动条；

        striped设置为true后表示显示斑马线，这是一个显示样式，试一下便知；

        nowrap设置为true后表示当数据多的时候不换行，否则某一行数据多的时候会换行，会比较难看；

        pagination设置为true后表示开启分页功能；

        singleSelect设置为true时，只允许勾选单行，全选功能失效，主要用于最前面一列的复选框；

        frozenColums是为了设置冻结列，在frozenColums中设置的列，不会改变大小。里面如果设置了{field:'checkbox',checkbox:true},表示这是个复选框列，给用户勾选用的，如果设置了上面的singleSelect，那么只能选择一项，不能全选；

        rowStyler是设置所有行的样式的，两个参数为行索引和行，上面设置的是偶数行是白色，奇数行是黄色。


## 常见问题
1. JavaEE6中具有beans验证功能，单独测试Hibernate框架会有出现找不都default factory的异常，解决方案：hibernate.cfg.xml添加<property name="javax.persistence.validation.mode">none</property>
2. 在用户管理中，我只想一对多级联删除usercollect表，不想在查询user表的时候再把usercollect查询出来，毕竟我不需要显示他。。


## 9月14日
### 主页数据加载
1， 先显示热门商品信息

     from Goods order by hit desc

2， 根据类别显示最新商品信息，需要修改数据库，添加一个gid字段，同时多对一关联查询类别

	from Goods where gid=:gid order by releaseDate desc


## 9月15日
### 商品列表页
1， 点击子类别可以查看商品列表，商品列表页只有在请求的范围内才有效，所以放在request范围内。

2， 进入商品详情页，同样商品详情页也是放在request范围内
3， 对goods和goodstype配置二级缓存，二级缓存对subtype无效，因为goodtype加载subtype的时候lazy=false

4, 发布（求购）商品，由于前期考录不周，price类型仍然为int型。tag为0正在交易，tag为1表示交易完成或者取消交易，bizType为0表示发布闲置，1表示求购。

5, 主页或者商品列表页每点击一个商品，hit+1

6， 用户模块：

- 登录：在UserAction中创建createImage方法，VerifyCodeUtil默认单例模式

## 9月16日
## 我的闲置和收藏夹制作
1， 显示我的闲置，点击商品进入更新页面，更新完成后hit重置为0

